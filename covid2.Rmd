```{r}
library(rehh)
library(ggplot2)
library(dplyr)
library(tidyverse)
library(data.table)
library(DBI)
library(RSQLite)

filename <- file.choose()
covid <- readRDS(filename)
```


```{r}
filename <- file.choose()
covid_2<- readRDS(filename)
```

```{r}
covid %>% filter(gene == "S") %>% count(aa_change) %>% arrange(-n)
```

```{r}
covid %>% filter(gene == "S") %>% count(effect) %>% arrange(-n)
```

```{r}

ggplot(data = covid, mapping = aes(x = position)) +
  geom_histogram()

```

```{r}

covid3 <- covid %>%
  filter(effect == "synonymous_variant", gene == "ORF1ab")

ggplot(data = covid3, mapping = aes(x = position)) +
  geom_histogram()
```

```{r}
covid_snp_sub <- covid_2[,c("id","date","VarShort")] 
covid_ann_sub <- covid3[,c("id","position","aa_change")]
covid4 <- merge(covid_ann_sub,covid_snp_sub,by = "id")
```

```{r}
covid5 <- covid4 %>%
  filter(aa_change == "F924F")
ggplot(data = covid5, mapping = aes(x = date)) +
  geom_histogram()
```

```{r}
tb1 <- table(covid5$date)
tb2 <- table(covid_2$date)


```

